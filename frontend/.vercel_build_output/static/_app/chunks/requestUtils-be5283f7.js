import{B as i,n as h,g as d}from"./constants-3794c139.js";import{D as l}from"./vendor-37e7558d.js";const p=l({}),n=s=>{{const e=localStorage.getItem(s);if(e)return e}return null},w=(s,e)=>{localStorage.setItem(s,e)},j=async(s,e,r)=>{try{const t={};if(!(r instanceof FormData)){t["Content-Type"]="application/json",r=JSON.stringify(r);const o=n("refreshToken");o&&(t.Authorization=`Bearer ${o}`);const a=await s(e,{method:"POST",body:r,headers:t});if(a.status===400){const c=(await a.json()).user.error[0];return[{},c]}return[await a.json(),""]}}catch(t){return console.error(`Error outside: ${t}`),[{},`An unknown error occurred. ${t}`]}},y=async(s,e,r)=>{const o=await(await s(e,{method:"POST",mode:"cors",headers:{"Content-Type":"application/json"},body:JSON.stringify({refresh:`${n("refreshToken")}`})})).json(),a=await s(r,{headers:{Authorization:`Bearer ${o.access}`}});if(a.status===400){const c=(await a.json()).user.error[0];return["",c]}return[(await a.json()).user,""]},S=async()=>{const e=await(await fetch(`${i}/token/refresh/`,{method:"POST",mode:"cors",headers:{"Content-Type":"application/json"},body:JSON.stringify({refresh:`${n("refreshToken")}`})})).json(),r=await fetch(`${i}/logout/`,{method:"POST",mode:"cors",headers:{Authorization:`Bearer ${e.access}`,"Content-Type":"application/json"},body:JSON.stringify({refresh:`${n("refreshToken")}`})});if(r.status!==204){const o=(await r.json()).user.error[0];throw{id:o.id,message:o}}localStorage.removeItem("refreshToken"),p.set({}),h.set("You have successfully logged out."),await d("/accounts/login")};export{w as a,n as b,y as g,S as l,j as p,p as u};
